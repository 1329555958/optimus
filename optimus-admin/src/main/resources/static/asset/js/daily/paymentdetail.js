/*! hx 2016-05-17 13 */
require("app").register.controller("paymentDeatilController",function($scope,$myhttp,$timeout,$location){function query(){if(!param.subjectNo)return void angular.info("找不到相关产品!");if("FUND"===param.type)$scope.queryPage=queryFundRecords;else{if("SUBJECT"!==param.type)return void angular.info("产品类型不正确!");if("ACTION_PROVISION_INVEST"===param.actionType)$scope.queryPage=queryPaymentRecords;else if("ACTION_PROVISION_REPAYMENT"===param.actionType)$scope.queryPage=queryRepaymentRecords;else if("PAYMENT_OUT"===param.paymentType)$scope.queryPage=queryPaymentRecords;else{if("PAYMENT_IN"!==param.paymentType)return void angular.info("出入款类型不正确!");$scope.queryPage=queryRepaymentRecords}}$scope.queryPage()}function queryPaymentRecords(page){$scope.loading=!0;var p={};p.pageNum=page||1,p.subjectNo=param.subjectNo,p.statusList="PAY_SUCCESS,BID_SUCCESS","ACTION_PROVISION_INVEST"===param.actionType&&(p.plat=param.plat),$myhttp("loading",$scope).get("/product/investRecords",p,angular.ajaxIsSuccess(function(result){pagination.currentPage=result.pageIndex,pagination.totalPage=result.pageCount,$scope.paymentRecords=result.result}))}function queryRepaymentRecords(page){$scope.loading=!0;var p={};p.pageNum=page||1,p.subjectNo=param.subjectNo,"ACTION_PROVISION_REPAYMENT"===param.actionType&&(p.plat=param.toPlat),$myhttp("loading",$scope).get("/product/repaymentRecords",p,angular.ajaxIsSuccess(function(result){pagination.currentPage=result.pageIndex,pagination.totalPage=result.pageCount,$scope.repaymentRecords=result.result}))}function queryFundRecords(page){$scope.loading=!0;var p={};p.pageNum=page||1,p.endTime=param.endTime,$myhttp("loading",$scope).get("/fund/orders",p,function(result){pagination.currentPage=result.pageIndex,pagination.totalPage=result.pageCount,$scope.fundRecords=result.result})}var param=$scope.param=$location.search();$scope.fundRecords=[],$scope.paymentRecords=[],$scope.repaymentRecords=[],$scope.loading=!1,$scope.queryPage=null;var pagination=$scope.pagination={currentPage:1,totalPage:0};$timeout(query,300)});