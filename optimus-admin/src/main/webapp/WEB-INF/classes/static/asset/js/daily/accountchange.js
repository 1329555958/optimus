/*! hx 2016-05-17 13 */
require("app").register.controller("accountChangeController",function($scope,$location,$timeout,$myhttp){function refresh(){$scope.queryWaitExecs(),$scope.queryWaitAudits()}var param=$scope.param={},MANUAL_OUT="chan_manual_out";$scope.orders=[],$scope.waitOrders=[],$scope.reset=function(){param.orderType=MANUAL_OUT,param.amount=0,param.outerOrderId="",param.memo="",param.orderId="",$scope.disableInput=!1},$scope.hasError=!1,$scope.errorText="",$scope.loading=!1,$scope.execLoading=!1,$scope.auditLoading=!1,$scope.action=function(){$scope.hasError=!1,param.amount-0<=0&&($scope.hasError=!0,$scope.errorText="金额需大于0"),param.outerOrderId||($scope.hasError=!0,$scope.errorText="请输入凭证号"),$scope.hasError||($scope.loading=!0,console.log(param),$myhttp("loading",$scope).post("/account/payment",JSON.stringify(param),function(){angular.info("操作成功!"),$scope.reset(),refresh()}))},$scope.queryWaitExecs=function(){$scope.execLoading=!0,$myhttp("execLoading",$scope).get("/payment/waitexecs",null,function(result){$scope.orders=result||[]})},$scope.queryWaitAudits=function(){$scope.auditLoading=!0,$myhttp("auditLoading",$scope).get("/payment/waitOppositeAudits",null,function(result){$scope.waitOrders=result||[]})},$scope.selectOrder=function(o){param.orderType=o.orderType,param.amount=o.amount,param.orderId=o.orderId,param.memo=o.memo,$scope.disableInput=!0},$scope.reset(),$timeout(refresh,300)});